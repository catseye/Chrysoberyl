{# bespoke template #}
{% extends "base.html" %}

{% macro online_buttons(thing) -%}
  {% for impl in related('implementation-of', key=thing)|sort %}
    {% if data[impl].online_locations|length > 0 %}
      {% for loc in data[impl].online_locations|sort %}
        <a class="button" href="{{ filekey(loc) }}">
          {%- if data[thing].type == 'Game' -%}
            Play
          {%- else -%}
            Try It
          {%- endif %}
          Online ({{ data[loc].medium }})</a>
      {% endfor %}
    {% endif %}
  {% endfor %}
{%- endmacro %}

{% block content %}

<ul>
{%- for thing in data|sort -%}
  {%- if data[thing].type in ['Tool', 'Library', 'Platform'] and
        'Chris Pressey' in data[thing].authors and
        data[thing].development_stage not in ['idea', 'work in progress', 'abandoned', 'lost', 'archived'] -%}
    <li>
      <p>{{ link(thing) }} 
      (
      {%- for implementation in related('implementation_of', key=thing) -%}
        in {{ link(data[implementation].host_language) }}
      {%- endfor -%}
      )
      {{ online_buttons(thing) }}</p>

      {% if data[thing].description %}
        {{ md2html(data[thing].description) }}
      {% endif %}

      {% if data[thing].commentary %}
        {{ md2html(data[thing].commentary) }}
      {% endif %}
    </li>
  {%- endif -%}
{%- endfor -%}
</ul>

{% endblock content %}
