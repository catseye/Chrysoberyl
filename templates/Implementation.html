{% extends "base.html" %}

{% block byline %}
  {% if authors %}
    <p id="byline">
      by {{ linked_list(authors) }}
      {%- if auspices -%}
        , {{ linked_list(auspices) }}
      {%- endif -%}
    </p>
  {% endif %}
{% endblock byline %}

{% block description %}
  <p>This is
    {% if reference %}
      the reference
    {% else %}
      an
    {% endif %}
    implementation of the
    {{ data[implementation_of].type|lower }}
    <a href="{{ filekey(implementation_of) }}">{{ implementation_of }}</a>.
    
    It is
    {% if implementation_type %}
      <a href="{{ filekey(implementation_type) }}">{{ indefart(implementation_type) }}</a>,
    {% endif %}
    written in <a href="{{ filekey(host_language) }}">{{ host_language }}</a>
    {%- if host_platform %}
      for the <a href="{{ filekey(host_platform) }}">{{ host_platform }}</a> platform
    {%- endif %}
    {%- if implementation_type == 'compiler' %}
      that generates <a href="{{ filekey(target_language) }}">{{ target_language }}</a>
      {%- if target_platform %}
        for the <a href="{{ filekey(target_platform) }}">{{ target_platform }}</a> platform
      {%- endif %}
    {%- endif -%}.

    {% if in_distributions %}
      {% if in_distributions|length == 1 %}
        It is distributed in the <a href="{{ filekey(in_distributions[0]) }}">{{ in_distributions[0] }}</a>
        and it
      {% else %}
        It is found in these distributions:
        {% for distribution in in_distributions %}
          <a href="{{ filekey(distribution) }}">{{ distribution }}</a>,
        {% endfor %}
        and it
      {% endif %}
    {% else %}
      It
    {% endif %}
    {% if license == 'Public Domain' %}
      is in the <a href="{{ filekey('Public Domain') }}">public domain</a>
    {% elif license == 'Freely Redistributable' %}
      is freely redistributable unmodified for non-commercial purposes
    {%- elif license == 'Proprietary' %}
      is proprietary software
    {%- elif license == 'Unknown license' %}
      has unknown licensing terms
    {%- else %}
      is distributed under the
      <a href="{{ filekey(license) }}">{{ license }}</a>
    {%- endif -%}.
  </p>
  {% if description_html %}
    <p>{{ description_html }}</p>
  {% endif %}
{% endblock description %}

{% block content %}

{# these are lame right now #}

<h2>Dependencies</h2>

<p>To run this implementation, you need:</p>

<ul>
  {% if prebuilt_for_platforms|length > 1 %}
    <li>One of the following:
      <ul>
        {% for platform in prebuilt_for_platforms %}
          <li>an implementation of <a href="{{ filekey(platform) }}">{{ platform }}</a>
        {% endfor %}
      </ul>
    </li>
  {% elif prebuilt_for_platforms %}
    <li>an implementation of <a href="{{ filekey(prebuilt_for_platforms[0]) }}">{{ prebuilt_for_platforms[0] }}</a></li>
  {% else %}
    {% if data[host_language].generally_compiled or build_requirements %}
      <li>
        to build it first, for which you will need:
        <ul>
          {% if data[host_language].generally_compiled %}
            <li>
              an implementation of <a href="{{ filekey(host_language) }}">{{ host_language }}</a>
                (we suggest
                  {% for impl in related('implementation-of', key=host_language) %}
                    {{ link(impl) }}
                  {% endfor -%}
                )
              {% if host_platform %}
                {# NOTE use of 'and' instead of 'for' here to make yoob deps sound ok #}
                and the <a href="{{ filekey(host_platform) }}">{{ host_platform }}</a> platform
              {% endif %}
            </li>
          {% endif %}
          {% if build_requirements %}
            {% for requirement in build_requirements %}
              <li>
                <a href="{{ filekey(requirement) }}">{{ requirement }}</a>
              </li>
            {% endfor %}
          {% endif %}
        </ul>
      </li>
    {% endif %}
    {% if not data[host_language].generally_compiled %}
      <li>
        {# special case to make this not suck #}
        {% if host_language=='mp3' %}
          an {{ link('mp3') }} player (you're on your own here)
        {% else %}
          an implementation of <a href="{{ filekey(host_language) }}">{{ host_language }}</a>
          (we suggest
            {% for impl in related('implementation-of', key=host_language) %}
              {{ link(impl) }}
            {% endfor -%}
          )
          {% if host_platform %}
            for the <a href="{{ filekey(host_platform) }}">{{ host_platform }}</a> platform
          {% endif %}
        {% endif %}
      </li>
    {% endif %}
  {% endif %}
  {% if run_requirements %}
    {% for requirement in run_requirements %}
      <li>
        <a href="{{ filekey(requirement) }}">{{ requirement }}</a>
      </li>
    {% endfor %}
  {% endif %}
</ul>

{% endblock content %}
